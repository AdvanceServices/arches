{% extends "views/components/widgets/base.htm" %}
{% load i18n %}
{% load template_tags %}

{% block form %}
{% include 'views/components/map-widget-editor.htm' %}
{% endblock form %}

{% block report %}
<dt data-bind="text: label"></dt>
<dd data-bind="foreach: summaryDetails">
  <div style='margin-bottom:2px' data-bind="text: JSON.stringify($data.geometry)"></div>
</dd>
{% endblock report %}

{% block config_form %}
<div class="control-label map-config-header">{% trans "Map Properties" %}</div>

<div class="panel-group accordion" id="accordion">

    <!--ko if: context === 'report-header' -->
    <div class="panel">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-parent="#accordion" data-toggle="collapse" href="#map-config-controls" aria-expanded="false" class="collapsed">{% trans "Map Controls" %}</a>
            </h4>
        </div>
        <div class="panel-collapse collapse" id="map-config-controls" aria-expanded="false" style="height: 0px;">
            <div class="panel-body accordion-body">
                  <div class="control-label">
                      {% trans "Map Tools" %}
                  </div>
                  <div class="col-xs-12 pad-no crud-widget-container">

                      <div class="toggle-container">
                          <span class="switch switch-small" data-bind="css: {'on': mapControlsHidden}, click: mapControls.toggleMapControlsVisibility"><small></small></span>
                          <p class="arches-toggle-sm">{% trans "Hide basemap, overlay controls" %}</p>
                      </div>
                  </div>
                </div>
            </div>
    </div>
    <!-- /ko -->

    <div class="panel">
        <div class="panel-heading map-widget-config-accoridan-item">
            <h4 class="panel-title">
                <a data-parent="#accordion" data-toggle="collapse" href="#map-config-position" class="collapsed" aria-expanded="false" data-bind="click: function(){positionConfigOpen(!positionConfigOpen())}">{% trans "Position" %}
                    <i class="fa" data-bind="css: {'fa-caret-down': positionConfigOpen(), 'fa-caret-right': !positionConfigOpen()}"></i>
                </a>
            </h4>

        </div>
        <div class="panel-collapse collapse" id="map-config-position" aria-expanded="false" style="height: 0px;">
            <div class="panel-body accordion-body">
                <div class="control-label">
                    {% trans "Map Center Longitude" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" id="" placeholder="{% trans " Longitude (x coordinate) " %}" class="form-control input-md widget-input" data-bind="value: centerX, valueUpdate: 'keyup'">
                </div>
                <div class="control-label">
                    {% trans "Map Center Latitude" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" id="" placeholder="{% trans " Latitude (y coordinate) " %}" class="form-control input-md widget-input" data-bind="value: centerY, valueUpdate: 'keyup'">
                </div>
                <div class="control-label">
                    {% trans "Pitch" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" id="" placeholder="{% trans " Pitch (Degrees) " %}" class="form-control input-md widget-input" data-bind="value: pitch, valueUpdate: 'keyup'">
                </div>
                <div class="control-label">
                    {% trans "Bearing" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" id="" placeholder="{% trans " Bearing (Degrees) " %}" class="form-control input-md widget-input" data-bind="value: bearing, valueUpdate: 'keyup'">
                </div>
            </div>
        </div>
    </div>
    <div class="panel">

        <div class="panel-heading map-widget-config-accoridan-item">
            <h4 class="panel-title">
                <a data-parent="#accordion" data-toggle="collapse" href="#map-config-zoom" class="collapsed" aria-expanded="false" data-bind="click: function(){zoomConfigOpen(!zoomConfigOpen())}">{% trans "Zoom" %}
                    <i class="fa" data-bind="css: {'fa-caret-down': zoomConfigOpen(), 'fa-caret-right': !zoomConfigOpen()}"></i>
                </a>
            </h4>
        </div>

        <div class="panel-collapse collapse" id="map-config-zoom" aria-expanded="false" style="height: 0px;">
            <div class="panel-body accordion-body">
                <div class="control-label">
                    {% trans "Default Zoom" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" min=1 max=20 id="" placeholder="{% trans " Zoom Level " %}" class="form-control input-md widget-input" data-bind="value: zoom, valueUpdate: 'keyup'">
                </div>
                <div class="control-label">
                    {% trans "Min Zoom" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" min=1 max=20 id="" placeholder="{% trans " Zoom Level " %}" class="form-control input-md widget-input" data-bind="value: minZoom, valueUpdate: 'keyup'">
                </div>
                <div class="control-label">
                    {% trans "Max Zoom" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" min=1 max=20 id="" placeholder="{% trans " Zoom Level " %}" class="form-control input-md widget-input" data-bind="value: maxZoom, valueUpdate: 'keyup'">
                </div>
            </div>
        </div>
    </div>
    <div class="panel">

        <div class="panel-heading map-widget-config-accoridan-item">
            <h4 class="panel-title">
                <a data-parent="#accordion" data-toggle="collapse" href="#map-config-geocoder" aria-expanded="false" class="collapsed" data-bind="click: function(){geocoderConfigOpen(!geocoderConfigOpen())}">{% trans "Geocoder" %}
                    <i class="fa" data-bind="css: {'fa-caret-down': geocoderConfigOpen(), 'fa-caret-right': !geocoderConfigOpen()}"></i>
                </a>
            </h4>
        </div>

        <div class="panel-collapse collapse" id="map-config-geocoder" aria-expanded="false" style="height: 0px;">
            <div class="panel-body accordion-body">
                <div class="control-label">
                    {% trans "Default Geocoder" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <select type="" id="" placeholder="{% trans " Geocoder " %}" data-bind="options: geocodingProviders, optionsText:'name', optionsValue:'geocoderid', value: geocodeProvider, chosen: {width: '100%'}"></select>
                </div>
                <div class="control-label">
                    {% trans "Geocoder Placehoder" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="text" placeholder="{% trans " Geocoder Placehoder " %}" class="form-control input-md widget-input" data-bind="value: geocodePlaceholder, valueUpdate: 'keyup'">
                </div>
                <div class="control-label">
                    {% trans "Geocoder Availability" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <div class="toggle-container">
                        <span class="switch switch-small" data-bind="css: {'on': geocoderVisible}, click: function () { geocoderVisible(!geocoderVisible()) }"><small></small></span>
                        <p class="arches-toggle-sm">{% trans "Toggle on to show a geocoder on the map" %}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="panel">
        <div class="panel-heading map-widget-config-accoridan-item">
            <h4 class="panel-title">
                <a data-parent="#accordion" data-toggle="collapse" href="#map-config-resource-style" aria-expanded="false" class="collapsed" data-bind="click: function(){resourcePropertiesConfigOpen(!resourcePropertiesConfigOpen())}">{% trans "Resource Properties" %}
                <i class="fa" data-bind="css: {'fa-caret-down': resourcePropertiesConfigOpen(), 'fa-caret-right': !resourcePropertiesConfigOpen()}"></i>
                </a>
            </h4>
        </div>

        <div class="panel-collapse collapse" id="map-config-resource-style" aria-expanded="false" style="height: 0px;">
            <div class="panel-body accordion-body">
                <div class="control-label">{% trans "Color" %}</div>

                <div class="col-xs-12 pad-no crud-widget-container">
                  <div class="colorpicker-component input-group">
                    <input placeholder="{% trans " Map Feature Color " %}" class="form-control input-lg widget-input" data-bind="colorPicker: {color: featureColor, format:'rgba'}">
                    <span class="input-group-addon"><i class="ion-stop resource-color-swatch" data-bind="style: {color: featureColor}"></i></span>
                  </div>
                </div>

                <div class="control-label">{% trans "Point Size" %}</div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" min="1" placeholder="{% trans " Map Feature Color " %}" class="form-control input-lg widget-input" data-bind="value: featurePointSize, valueUpdate: 'keyup'">
                </div>

                <div class="control-label">{% trans "Line Width" %}</div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input type="number" min="1" placeholder="{% trans " Map Feature Color " %}" class="form-control input-lg widget-input" data-bind="value: featureLineWidth, valueUpdate: 'keyup'">
                </div>

                <div class="control-label">{% trans "Available Geometry Types" %}</div>
                <div class="col-xs-12 pad-no crud-widget-container">
                    <input id="select2Input2" data-bind="
                      select2v4Data: geometryTypes,
                      select2v4: geomTypeSelectSetup" style="width: 100%">
                    </input>
                </div>
            </div>
        </div>

    </div>

    <div class="panel">

        <div class="panel-heading map-widget-config-accoridan-item">
            <h4 class="panel-title">
                <a data-parent="#accordion" data-toggle="collapse" href="#map-config-default-value" aria-expanded="false" class="collapsed" data-bind="click: function(){defaultValueConfigOpen(!defaultValueConfigOpen())}">{% trans "Default Value" %}
                    <i class="fa" data-bind="css: {'fa-caret-down': defaultValueConfigOpen(), 'fa-caret-right': !defaultValueConfigOpen()}"></i>
                </a>
            </h4>
        </div>

        <div class="panel-collapse collapse" id="map-config-default-value" aria-expanded="false" style="height: 0px;">
            <div class="panel-body accordion-body">
                <div class="control-label">
                    {% trans "Select Location" %}
                </div>
                <div class="col-xs-12 pad-no crud-widget-container" style="height: 200px;">
                    <select type="" id="" placeholder="{% trans " Default Value " %}" data-bind="options: defaultValueOptions, optionsText:'name', optionsValue:'defaultOptionid', value: defaultValueType, chosen: {width: '100%', allow_single_deselect: true, disable_search: true}"></select>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock config_form %}

{% block display_value %}
<span data-bind="text: displayValue()"></span> {% trans "feature(s)" %}
{% endblock display_value %}
