{% load i18n %}
{% load template_tags %}


<div>
    <table>
        <tbody>
            <!-- ko foreach: { data: Object.keys(OBSERVATIONS_CSV_COLUMN_NAME_TO_NODE_IDS), as: 'key' } -->
            <tr>
                <td data-bind="text: key"></td>
                    <td data-bind="
                        text: (function() {
                            /* hack to format location */
                            var data = $parent['row_data'][OBSERVATIONS_CSV_COLUMN_NAME_TO_NODE_IDS[key]['node_id']];

                            if (data instanceof Object) {
                                if (OBSERVATIONS_CSV_COLUMN_NAME_TO_NODE_IDS[key]['args'].includes('x')) {
                                    return data['features'][0]['geometry']['coordinates'][1];
                                }
                                if (OBSERVATIONS_CSV_COLUMN_NAME_TO_NODE_IDS[key]['args'].includes('y')) {
                                    return data['features'][0]['geometry']['coordinates'][0];
                                }
                            }
                            
                            return data;
                        })()
                    "></td>
                </tr>
            <!-- /ko -->
        </tbody>
    </table>
</div>