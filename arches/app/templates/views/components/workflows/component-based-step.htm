{% load i18n %}
<div
    style="height: 100%; padding: 10px 24px;"
>
    <!-- ko foreach: { data: pageLayout(), as: 'layoutSection'} -->
    <div
        style="padding: 10px 0;"
    >
        <div>
            <h4
                style="font-weight: unset;"
                data-bind="text: layoutSection[0]"
            ></h4>
        </div>
        <!-- ko foreach: { data: layoutSection[1], as: 'componentFOOName'} -->
            <!-- ko if: !$parents[1].loading() -->
            <!-- ko with: $parents[1].componentFOOLookup[componentFOOName] -->
                <!-- ko if: manageMultipleTiles -->
                <!-- ko let: { self: $data } -->
                    <div data-bind="" class="wf-multi-tile-step-container">
                        <div class="wf-multi-tile-step-form">
                            <div data-bind="component: {
                                name: componentName,
                                params: {
                                    ...componentParameters,
                                    form: $data,
                                    pageVm: $root
                                }
                            }"></div>

                            <button 
                                class="btn btn-success" 
                                data-bind="click: addTile"
                            >
                                {% trans "Create" %}
                            </button>

                        </div>
                        <div class="wf-multi-tile-step-list">
                            <div><h4 data-bind="text: (itemName())"></h4></div>
                            <!-- ko if: addedTiles().length === 0 -->
                            <div class="wf-multi-tile-step-list-empty">
                                <p data-bind="text: ('No '+itemName()+' added yet. Add one or multiple '+itemName()+'.')"></p>
                            </div>
                            <!-- /ko -->
                            <!-- ko foreach: {data: addedTiles, as: 'tile'} -->
                            <div class="wf-multi-tile-step-card">
                                <div class="wf-multi-tile-card-info">
                                    <div class="workflow-step-icon complete"><span><i class="fa fa-hashtag"></i></span></div>
                                    <div class="wf-multi-tile-card-info-details">
                                        <!-- ko foreach: {data: $parent.card().widgets(), as: 'widget'} -->
                                            <!-- ko component: {
                                                        name: widget.widgetLookup[widget.get("widget_id")()].name,
                                                        params: {
                                                            config: widget.configJSON,
                                                            label: widget.label(),
                                                            node: widget.node,
                                                            value: $parent.data[widget.node_id()],
                                                            state: "report"
                                                        }
                                                    } --><!-- /ko -->
                                        <!-- /ko -->
                                    </div>
                                </div>
                                <div class="wf-multi-tile-step-card-controls">
                                    <span><i class="fa fa-times-circle"></i></span><span class="" data-bind="click: function(){$parent.remove(tile)}">{% trans "Remove" %}</span>
                                    <span><i class="fa fa-pencil"></i></span><span data-bind="click: function(){$parent.edit(tile);}">{% trans "Edit" %}</span>
                                </div>
                            </div>
                            <!-- /ko -->
                        </div>
                    </div>
                <!-- /ko -->
                <!-- /ko -->
                <!-- ko if: !manageMultipleTiles -->
                <div data-bind='{
                    component: {
                        name: componentName,
                        params: {
                            ...componentParameters,
                            pageVm: $root,
                            form: $data,
                        },
                    },
                }'></div>
                <!-- /ko -->
            <!-- /ko -->
            <!-- /ko -->
        <!-- /ko -->
    </div>
    <!-- /ko -->
</div>
