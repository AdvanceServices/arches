Arches 7.0.0 release notes
------------------------


### Major enhancements
- add frontend compiler ( webpack )
- removes Arches Collector and associated resources


### Additional highlights

  
### Dependency changes:
```
Python:
    Upgraded:
        none

### Breaking changes
- `media/packages` -> `media/node_modules` path change
- STATIC_ROOT, STATIC_FILES, STATICFILES_DIRS, and STATICFILES_STORAGE settings changed

### Dependency changes:
- adds django-webpack-loader==1.5.0

### Upgrading Arches
- in `settings.py`
    - ensure STATIC_ROOT = os.path.join(ROOT_DIR, "staticfiles")
    - ensure STATIC_URL = "/static/"
    - add os.path.join(APP_ROOT, "media", "build") to STATICFILES_DIRS **before** os.path.join(APP_ROOT, "media")
    - ensure "webpack_loader" has been added to INSTALLED_APPS
    - add setting:
        WEBPACK_LOADER = {
            "DEFAULT": {
                "STATS_FILE": os.path.join(APP_ROOT, "webpack/webpack-stats.json"),
            },
        }

### Upgrading an Arches project
- copy `/webpack` directory from arches directory to the root directory of your project ( should be on the same level as `package.json`)
- ensure ARCHES_CORE_PATH and PROJECT_PATH in `webpack/wwebpack-metadata.js` are pointing to the correct directories
- in `settings.py`:
    - add "webpack_loader" to list of INSTALLED_APPS
    - ensure STATIC_ROOT = os.path.join(APP_ROOT, "staticfiles")
    - if overwriting STATICFILES_DIRS, add os.path.join(APP_ROOT, "media", "build") **before** os.path.join(APP_ROOT, "media")
    - add setting:
        WEBPACK_LOADER = {
            "DEFAULT": {
                "STATS_FILE": os.path.join(APP_ROOT, "webpack/webpack-stats.json"),
            },
        }
- run `yarn`, this will install new frontend dependencies
- run `yarn build_development` or `yarn start`, this should generate compiled frontend files in `media/build`
- NOTE: If new JavaScript files have been created in your project, they may cause errors during the build process. You may need to troubleshoot these
        errors on a case-by-case basis until the application is able to build successfully
- All references to Arches Collector has been removed.
- `MOBILE_OAUTH_CLIENT_ID` has been renamed to `OAUTH_CLIENT_ID` in arches' core `settings.py` file.
    Added:
        none

Javascript:
    Upgraded:
        none

    Added:
        none
```


### Upgrading Arches
1. You must be upgraded to at least version 6.1.0 before proceeding.

2. Be sure to backup your database before proceeding.

3. Upgrade to Arches 7.0.0

        pip install --upgrade arches

4. Within your project with your Python 3 virtual environment activated:

        python manage.py migrate
        python manage.py updateproject
        python manage.py es reindex_database

5. **Important:** If you are maintaining an Arches package, be sure to export your graphs and resource instance data before re-importing or reloading your package.

### Breaking changes
- All references to Arches Collector have been removed.
- `MOBILE_OAUTH_CLIENT_ID` has been renamed to `OAUTH_CLIENT_ID` in arches' core `settings.py` file.

### Upgrading an Arches project
1. `MOBILE_OAUTH_CLIENT_ID` must be renamed to `OAUTH_CLIENT_ID` in your project's `settings.py` file.

2. If you are running Arches on Apache, be sure to run:

    ```
    python manage.py build_production
    ```
    and restart your server.
    ```
    sudo service apache2 reload
    ```

3. Finally, If you are running Celery, you should also restart your Celery worker(s). The process for doing this depends on how Celery is being run.